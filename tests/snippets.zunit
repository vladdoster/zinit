#!/usr/bin/env zunit

@setup {
  HOME="$zi_test_dir"
  typeset -gx completion_dir="$zi_test_dir/completions"
}

@test 'tldr-snippet' {
  run zinit for as'completion' id-as'tealdeer/_tldr' is-snippet nocompile https://raw.githubusercontent.com/dbrgn/tealdeer/main/completion/zsh_tealdeer
  assert $state equals 0; assert "$completion_dir/_tldr" is_file;

  run zinit delete --yes tealdeer/_tldr; 
  assert $state equals 0;

  run stat "$completion_dir/_tldr"
  assert $state equals 1; assert $output contains 'No such file or directory'
}

# vim:ft=zsh:sw=2:sts=2:et:foldmarker=@test,}:foldmethod=marker
